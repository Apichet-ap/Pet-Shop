<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ตะกร้าสินค้า</title>
    <link rel="stylesheet" href="style.css">
    <script>
        let cartItems = JSON.parse(localStorage.getItem('cart')) || [];

        function updateCartDisplay() {
            const cartList = document.getElementById('cart-list');
            cartList.innerHTML = '';
            cartItems.forEach((item, index) => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    ${item.name} - ${item.price} บาท
                    <input type="number" min="1" value="${item.quantity || 1}" onchange="updateQuantity(${index}, this.value)">
                    <button onclick="removeItem(${index})">ลบ</button>
                `;
                cartList.appendChild(listItem);
            });
        }

        function updateQuantity(index, quantity) {
            cartItems[index].quantity = parseInt(quantity);
            localStorage.setItem('cart', JSON.stringify(cartItems)); // Update localStorage
            updateCartDisplay();
        }

        function removeItem(index) {
            cartItems.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cartItems)); // Update localStorage
            updateCartDisplay();
        }

        function clearCart() {
            cartItems = [];
            localStorage.setItem('cart', JSON.stringify(cartItems)); // Update localStorage
            updateCartDisplay();
        }

        function proceedToCheckout() {
            if (cartItems.length === 0) {
                alert('ไม่มีสินค้าในตะกร้า กรุณาเพิ่มสินค้าก่อนชำระเงิน');
                return;
            }

            const originalPrice = cartItems.reduce((total, item) => total + (item.price * (item.quantity || 1)), 0);
            const discount = 20; // ตัวอย่างส่วนลด 20%
            const checkoutUrl = `checkout.html?price=${originalPrice}&discount=${discount}`;
            
            // เคลียร์สินค้าจากตะกร้า
            clearCart();

            // นำผู้ใช้ไปยังหน้า checkout
            window.location.href = checkoutUrl;
        }

        document.addEventListener('DOMContentLoaded', updateCartDisplay);
    </script>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <h1> Happy Pets</h1>
            <nav>
                <ul>
                    <li><a href="index.html">หน้าแรก</a></li>
                    <li><a href="products.html">สินค้าทั้งหมด</a></li>
                    <li><a href="about.html">เกี่ยวกับเรา</a></li>
                    <li><a href="contact.html">ติดต่อเรา</a></li>
                    <li><a href="cart.html">ตะกร้า (<span id="cart-count">0</span>)</a></li>
                    <li><a href="checkout.html">ชำระเงิน</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Cart Section -->
    <section class="cart">
        <div class="container">
            <h2>สินค้าที่อยู่ในตะกร้า</h2>
            <ul id="cart-list">
                <!-- รายการสินค้าในตะกร้าจะแสดงที่นี่ -->
            </ul>
            <button onclick="proceedToCheckout()">ชำระเงิน</button>
            <button onclick="clearCart()">ลบสินค้าทั้งหมด</button>
        </div>
    </section>
    
    <!-- Footer Section -->
    <footer>
        <div class="container">
            <p>&copy; 2024  Happy Pets. ทุกสิทธิ์ได้รับการคุ้มครอง.</p>
        </div>
    </footer>
</body>
</html> 